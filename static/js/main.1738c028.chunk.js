(this["webpackJsonpwebxr-image-targets-hole"]=this["webpackJsonpwebxr-image-targets-hole"]||[]).push([[0],{63:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(51),i=n.n(c),s=(n(63),n(11)),o=n.n(s),u=n(16),l=n(9),j=n(45),b=n(17),f=n(52);var d=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},m=Object(f.a)((function(e){return{balls:[],addBall:function(){return e((function(e){return{balls:[].concat(Object(b.a)(e.balls),["ball-".concat(d())])}}))},removeBall:function(t){return e((function(e){return{balls:e.balls.filter((function(e){return e!==t}))}}))},isXR:!1}})),h=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",createImageBitmap(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){return e.close()},g=function(){var e=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){h(t).then((function(t){e({image:{image:t,widthInMeters:n},destroy:function(){return p(t)}})})).catch((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=n(0),x=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getTrackedImageScores());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){},w=function(e,t){var n=e.getImageTrackingResults();if(0!==n.length){var r=e.getPose(n[0].imageSpace,t),a=new O.Vector3,c=new O.Quaternion;return{emulated:"emulated"===n[0].trackingState,measuredWidth:n[0].measuredWidthInMeters,position:a.copy(r.transform.position),rotation:c.copy(r.transform.orientation)}}},y=n(6),S=n(15),k=n(27),R=n(47),I=function(e){var t=Object(S.g)().gl,n=Object(r.useRef)(),a=Object(r.useRef)(),c=Object(r.useCallback)((function(r,i){void 0!==a.current&&e(r,i),a.current=r,n.current=t.xr.getSession().requestAnimationFrame(c)}),[t.xr,e]);Object(r.useEffect)((function(){var e;if((null===(e=t.xr)||void 0===e?void 0:e.isPresenting)||n.current)return n.current=t.xr.getSession().requestAnimationFrame(c),function(){t.xr.getSession().cancelAnimationFrame(c)}}),[t,t.xr.isPresenting,c])},M=function(){var e=Object(r.useMemo)((function(){return{isSupported:!!window.XRImageTrackingResult}}),[]),t=Object(r.useMemo)((function(){return{onSessionStart:x,onSessionEnd:v,onFrameUpdate:w}}),[]),n=Object(r.useState)(),a=Object(l.a)(n,2),c=a[0],i=a[1],s=Object(S.g)().gl,b=Object(j.b)().isPresenting,f=Object(r.useCallback)((function(e,n){var r=t.onFrameUpdate(n,s.xr.getReferenceSpace());i(r)}),[s.xr,t]);return I(f),Object(r.useEffect)((function(){if(e.isSupported&&b){var n=s.xr.getSession();return function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.onSessionStart(n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()(),function(){t.onSessionEnd(),i(null)}}}),[s.xr,b,t,f,e.isSupported]),c},P=n(5),B=function(){var e=m(),t=Object(k.b)((function(){return{mass:0,position:[0,-1,0],rotation:[-Math.PI/2,0,0],onCollide:function(t){return e.removeBall(t.body.name)}}})),n=Object(l.a)(t,1)[0];return Object(P.jsxs)("mesh",{ref:n,children:[Object(P.jsx)("planeBufferGeometry",{attach:"geometry",args:[5,5]}),Object(P.jsx)("meshStandardMaterial",{opacity:0,transparent:!0,attach:"material",color:"#171717"})]})},F=n(72),L=function(e){var t=Object(F.a)("".concat("/webxr-image-targets-hole","/bowl.glb")).nodes,n=t.Cylinder.geometry,r=n.attributes.position.array,a=n.index.array,c=Object(k.d)((function(){return{mass:0,rotation:e.rotation,args:[r,a]}})),i=Object(l.a)(c,1)[0];return Object(P.jsx)("mesh",Object(y.a)(Object(y.a)({ref:i,geometry:t.Cylinder.geometry,receiveShadow:!0},e),{},{children:Object(P.jsx)("meshStandardMaterial",{opacity:0,transparent:!0})}))},C=n(44),E=function(e){var t=e.name,n=e.startPos,r=e.opacity,a=Object(k.c)((function(){return{mass:.5,position:n,args:.1}})),c=Object(l.a)(a,1)[0];return Object(P.jsxs)(C.a.mesh,{receiveShadow:!0,castShadow:!0,name:t,ref:c,children:[Object(P.jsx)("sphereBufferGeometry",{attach:"geometry",args:[.1,64,64]}),Object(P.jsx)(C.a.meshStandardMaterial,{transparent:!0,opacity:r,attach:"material",color:"#43467F"})]})},N=function(e,t){var n=e+(t-e)*Math.random();return Number(n.toFixed(1))};var A=function(){var e=M(),t=Object(r.useRef)(),n=m((function(e){return e.balls})),a=Object(S.g)().gl,c=Object(R.useTransition)(n,{keys:function(e){return e},from:{opacity:0},enter:{opacity:1},leave:{opacity:0}},[n.length]),i=Object(l.a)(c,1)[0];return Object(r.useEffect)((function(){m.setState({isXR:a.xr.isPresenting})}),[a.xr.isPresenting]),Object(S.e)((function(){t.current&&(a.xr.isPresenting&&!(null===e||void 0===e?void 0:e.emulated)?e&&(t.current.visible=!0,t.current.position.copy(e.position),t.current.rotation.copy(e.rotation)):t.current.visible=!1)})),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("hemisphereLight",{intensity:.35}),Object(P.jsx)(k.a,{children:Object(P.jsxs)("group",{ref:t,children:[Object(P.jsx)("ambientLight",{intensity:1.5}),Object(P.jsx)("pointLight",{position:[100,100,100],intensity:2,castShadow:!0}),Object(P.jsx)("pointLight",{position:[-100,-100,-100],intensity:5,color:"#262424"}),Object(P.jsxs)("group",{scale:[.05,.05,.05],children:[Object(P.jsx)(B,{}),Object(P.jsx)(L,{}),i((function(e,t,n){return Object(P.jsx)(E,Object(y.a)(Object(y.a)(Object(y.a)({},t),e),{},{name:t,startPos:[N(-.5,.5),9,N(-.5,.5)]}))}))]})]})})]})};var T=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e})),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){"undefined"!==typeof(null===n||void 0===n?void 0:n.current)&&(null===n||void 0===n||n.current())}),t);return function(){return clearInterval(e)}}}),[t])};var q=function(){var e=m(),t=Object(r.useRef)(),n=Object(r.useState)(),a=Object(l.a)(n,2),c=a[0],i=a[1];T((function(){e.addBall()}),e.isXR?3e3:null);var s=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g(t.current,.1);case 3:n=e.sent,i(n.image),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:"intro",children:[Object(P.jsxs)("section",{children:[Object(P.jsx)("h1",{className:"title",children:"WebXR Image Target \u2013 Hole"}),Object(P.jsx)("img",{className:"trackedImage",onLoad:function(){return s()},alt:"webxr imagetracking by thomas rutzer",ref:t,src:"/webxr-image-targets-hole/trackedImage.png"})]}),Object(P.jsx)("section",{children:Object(P.jsxs)("ol",{className:"explanation",children:[Object(P.jsxs)("li",{children:[Object(P.jsxs)("button",{onClick:function(){return window.print()},children:["Print image",Object(P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"#e2e2e2",strokeWidth:"2",strokeLinecap:"square",strokeLinejoin:"arcs",children:Object(P.jsx)("path",{d:"M7 17l9.2-9.2M17 17V7H7"})})]}),"  10cm x 10cm"]}),Object(P.jsx)("li",{children:"Start AR"}),Object(P.jsx)("li",{children:"Scan image on flat surface"})]})}),Object(P.jsxs)("section",{children:[Object(P.jsx)("hr",{}),Object(P.jsxs)("small",{className:"compatibility",children:["Currently only available in Chrome for Android >=89, with flag ",Object(P.jsx)("span",{className:"snippet",children:"chrome://flags#webxr-incubations"})," active"]}),Object(P.jsxs)("small",{className:"credit",children:["by ",Object(P.jsxs)("a",{href:"https://thomasrutzer@github.io",target:"blank",children:["Thomas Rutzer",Object(P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",strokeWidth:"2",strokeLinecap:"square",strokeLinejoin:"arcs",children:Object(P.jsx)("path",{d:"M7 17l9.2-9.2M17 17V7H7"})})]})]})]})]}),c&&Object(P.jsx)(j.a,{style:{position:"absolute",left:0,top:0},sessionInit:{requiredFeatures:["image-tracking"],trackedImages:[c]},children:Object(P.jsx)(A,{})})]})};i.a.render(Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(q,{})}),document.getElementById("root"))}},[[70,1,2]]]);
//# sourceMappingURL=main.1738c028.chunk.js.map