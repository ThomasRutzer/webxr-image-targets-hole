{"version":3,"sources":["utils/createUUID.js","store.js","services/xr/trackableImage.js","services/xr/imageTracking.js","utils/useXRFrame.js","utils/useXRTrackedImage.js","components/Collider.js","components/Bowl.js","components/Ball.js","utils/randomRange.js","components/Scene.js","utils/useInterval.js","components/App.js","index.js"],"names":["createUUID","replace","c","crypto","getRandomValues","Uint8Array","toString","useStore","create","set","balls","addBall","state","removeBall","ballUUID","filter","currBall","isXR","setXR","prepareImage","imageBitmapSrc","a","createImageBitmap","destroyImage","bitmap","close","trackableImage","image","width","Promise","res","rej","then","widthInMeters","destroy","catch","e","onXrSessionStart","session","getTrackedImageScores","onXrSessionEnd","onXrFrameUpdate","frame","referenceSpace","trackingResults","getImageTrackingResults","length","pose","getPose","imageSpace","position","Vector3","rotation","Quaternion","emulated","trackingState","measuredWidth","measuredWidthInMeters","copy","transform","orientation","useXRFrame","callback","gl","useThree","requestRef","useRef","previousTimeRef","loop","useCallback","time","xrFrame","undefined","current","xr","getSession","requestAnimationFrame","useEffect","isPresenting","cancelAnimationFrame","useXrTrackedImage","xrDeviceState","useMemo","isSupported","window","XRImageTrackingResult","xrImageTracking","onSessionStart","onSessionEnd","onFrameUpdate","useState","imageTrackingResult","setImageTrackingResult","useXR","xrImageTrackingUpdate","getReferenceSpace","console","log","checkCanTrack","Collider","store","usePlane","mass","Math","PI","onCollide","body","name","ref","attach","args","opacity","transparent","color","Bowl","props","nodes","useGLTF","process","geometry","Cube","vertices","attributes","array","indices","index","useTrimesh","receiveShadow","Ball","startPos","map","useLoader","TextureLoader","useSphere","mesh","castShadow","meshBasicMaterial","randomRange","min","max","result","random","Number","toFixed","Scene","group","s","useTransition","keys","item","from","enter","leave","transitions","useFrame","visible","intensity","angle","penumbra","shadow-mapSize-width","shadow-mapSize-height","scale","useInterval","delay","savedCallback","id","setInterval","clearInterval","App","setTrackableImage","doCreateTrackableImage","createTrackableImage","currTrackableImage","className","onLoad","alt","src","onClick","print","xmlns","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","href","target","style","left","top","sessionInit","requiredFeatures","trackedImages","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.357ee62d.chunk.js","sourcesContent":["function createUUID() {\n  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n    // eslint-disable-next-line\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  )\n}\n\nexport default createUUID","import create from \"zustand\"\n\nimport createUUID from \"./utils/createUUID\"\n\nconst useStore = create(set => ({\n  balls: [],\n  addBall: () => set(state => ({ balls: [...state.balls, `ball-${createUUID()}`] })),\n  removeBall: ballUUID => set(state => ({\n    balls: state.balls.filter(currBall => currBall !== ballUUID)\n  })),\n  isXR: false,\n  setXR: isXR => set(state => ({ isXR }))\n}))\n\nexport default useStore","const prepareImage = async imageBitmapSrc => {\n  return createImageBitmap(imageBitmapSrc)\n}\n\nconst destroyImage = bitmap => {\n  return bitmap.close()\n}\n\nexport const trackableImage = async (image, width) => {\n  return new Promise((res, rej) => {\n    prepareImage(image)\n      .then(bitmap => {\n        res({\n          image: {\n            image: bitmap,\n            widthInMeters: width\n          },\n          destroy: () => destroyImage(bitmap)\n        })\n      })\n      .catch(e => rej(e))\n  })\n}","import { Vector3, Quaternion } from \"three\"\n\nconst onXrSessionStart = async (session) => {\n  return session.getTrackedImageScores()\n}\n\nconst onXrSessionEnd = () => {\n\n}\n\nconst onXrFrameUpdate = (frame, referenceSpace) => {\n  const trackingResults = frame.getImageTrackingResults()\n\n  if (trackingResults.length === 0) return\n\n  const pose = frame.getPose(trackingResults[0].imageSpace, referenceSpace)\n  const position = new Vector3()\n  const rotation = new Quaternion()\n\n  return {\n    emulated: trackingResults[0].trackingState === \"emulated\",\n    measuredWidth: trackingResults[0].measuredWidthInMeters,\n    position: position.copy(pose.transform.position),\n    rotation: rotation.copy(pose.transform.orientation)\n  }\n}\n\nexport const imageTracking = () => {\n  return ({\n    onSessionStart: onXrSessionStart,\n    onSessionEnd: onXrSessionEnd,\n    onFrameUpdate: onXrFrameUpdate,\n  })\n}","import { useCallback, useEffect, useRef } from \"react\"\nimport { useThree } from \"react-three-fiber\"\n\nconst useXRFrame = callback => {\n  const { gl } = useThree()\n  const requestRef = useRef()\n  const previousTimeRef = useRef()\n\n  const loop = useCallback((time, xrFrame) => {\n    if (previousTimeRef.current !== undefined) {\n      callback(time, xrFrame)\n    }\n\n    previousTimeRef.current = time\n    requestRef.current = gl.xr.getSession().requestAnimationFrame(loop)\n  }, [gl.xr, callback])\n\n  useEffect(() => {\n    if (!gl.xr?.isPresenting && !requestRef.current) {\n      return\n    }\n\n    requestRef.current = gl.xr.getSession().requestAnimationFrame(loop)\n\n    return () => {\n      gl.xr.getSession().cancelAnimationFrame(loop)\n    }\n  }, [gl, gl.xr.isPresenting, loop])\n}\n\nexport default useXRFrame","import { useEffect, useState, useMemo, useCallback } from \"react\"\nimport { useXR } from \"@react-three/xr\"\nimport { useThree } from \"react-three-fiber\"\n\nimport { imageTracking } from \"../services/xr\"\nimport useXRFrame from \"./useXRFrame\"\n\nexport const useXrTrackedImage = () => {\n  const xrDeviceState = useMemo(() => ({\n    isSupported: !!window.XRImageTrackingResult\n  }), [])\n  const xrImageTracking = useMemo(() => imageTracking(), [])\n  const [imageTrackingResult, setImageTrackingResult] = useState()\n  const { gl } = useThree()\n  const { isPresenting } = useXR()\n\n  const xrImageTrackingUpdate = useCallback((time, xrFrame) => {\n    const imageTrackingResult = xrImageTracking.onFrameUpdate(xrFrame, gl.xr.getReferenceSpace())\n    setImageTrackingResult(imageTrackingResult)\n  }, [gl.xr, xrImageTracking])\n\n  useXRFrame(xrImageTrackingUpdate)  \n\n  useEffect(() => {\n    if (!xrDeviceState.isSupported || !isPresenting) return\n\n    const session = gl.xr.getSession()\n\n    const checkCanTrack = async () => {\n      try {\n        await xrImageTracking.onSessionStart(session)\n      } catch (err) {\n        console.log(err);\n      }\n    }\n\n    checkCanTrack()\n\n    return () => {\n      xrImageTracking.onSessionEnd()\n      setImageTrackingResult(null)\n    }\n  }, [gl.xr, isPresenting, xrImageTracking, xrImageTrackingUpdate, xrDeviceState.isSupported])\n\n  return imageTrackingResult\n}\n\nexport default useXrTrackedImage","import { usePlane } from \"@react-three/cannon\"\n\nimport useStore from \"./../store\"\n\nconst Collider = () => {\n  const store = useStore()\n  const [ref] = usePlane(() => (\n    { mass: 0, \n      position: [0, -1, 0],\n      rotation: [-Math.PI / 2, 0, 0],\n      onCollide: e => store.removeBall(e.body.name) \n    }))\n\n  return (\n    <mesh ref={ref}>\n      <planeBufferGeometry attach=\"geometry\" args={[5, 5]} />\n      <meshStandardMaterial opacity={0} transparent={true} attach=\"material\" color=\"#171717\" />\n    </mesh>\n  )\n}\n\nexport default Collider","import { useTrimesh } from \"@react-three/cannon\"\nimport { useGLTF } from \"@react-three/drei\"\n\nconst Bowl = (props) => {\n  const { nodes } = useGLTF(`${process.env.PUBLIC_URL}/hole.glb`)\n  const geometry = nodes.Cube.geometry\n  const vertices = geometry.attributes.position.array\n  const indices = geometry.index.array\n\n  const [ref] = useTrimesh(() => ({\n    mass: 0,\n    rotation: props.rotation,\n    args: [vertices, indices],\n  }))\n\n  return (\n    <mesh\n      ref={ref}\n      geometry={nodes.Cube.geometry}\n      receiveShadow\n      {...props}>\n      <meshStandardMaterial opacity={0} transparent={true} />\n    </mesh>\n  )\n}\n\nexport default Bowl","import { TextureLoader } from \"three\"\nimport { useLoader } from \"react-three-fiber\"\nimport { useSphere } from \"@react-three/cannon\"\nimport { a } from \"@react-spring/three\"\n\nconst Ball = ({ name, startPos, opacity }) => {\n  const map = useLoader(TextureLoader, `${process.env.PUBLIC_URL}/ballMaterial.jpg`)\n  const [ref] = useSphere(() => ({ mass: 1, position: startPos, args: 0.1 }))\n\n  return (\n    <a.mesh\n     receiveShadow\n      castShadow \n      name={name}\n      ref={ref}>\n      <sphereBufferGeometry attach=\"geometry\" args={[0.1, 64, 64]} />\n      <a.meshBasicMaterial\n        transparent\n        opacity={opacity}\n        attach=\"material\"\n        map={map}\n      />\n    </a.mesh>\n  )\n}\n\nexport default Ball","const randomRange = (min, max) => {\n  const result = min + (max - min) * Math.random()\n  return Number(result.toFixed(1))\n}\n\nexport default randomRange","import React, { useEffect, useRef } from \"react\"\nimport { useFrame, useThree } from \"react-three-fiber\"\nimport { Physics } from \"@react-three/cannon\"\nimport { useTransition } from '@react-spring/three'\n\nimport useStore from \"./../store\"\nimport useXrTrackedImage from \"../utils/useXRTrackedImage\"\nimport Collider from \"./Collider\"\nimport Bowl from \"./Bowl\"\nimport Ball from \"./Ball\"\nimport randomRange from \"./../utils/randomRange\"\n\nfunction Scene() {\n  const imageTrackingResult = useXrTrackedImage()\n  const group = useRef()\n  const balls = useStore(s => s.balls)\n  const setXR = useStore(s => s.setXR)\n  const { gl } = useThree()\n\n  const [transitions] = useTransition(\n    balls,\n    {\n      keys: item => item,\n      from: { opacity: 0 },\n      enter: { opacity: 1 },\n      leave: { opacity: 0 }\n    },\n    [balls.length]\n  )\n\n  useEffect(() => {\n    setXR(gl.xr.isPresenting)\n  }, [gl.xr.isPresenting])\n\n  useFrame(() => {\n    if (!group.current) return\n\n    if (!gl.xr.isPresenting || imageTrackingResult?.emulated) {\n      group.current.visible = false\n      return\n    }\n\n    if (imageTrackingResult) {\n      group.current.visible = true\n\n      group.current.position.copy(imageTrackingResult.position)\n      group.current.rotation.copy(imageTrackingResult.rotation)\n    }\n  })\n\n  return (\n    <>\n      <hemisphereLight intensity={0.35} />\n      <Physics>\n        <group ref={group}>\n          <spotLight\n            position={[30, 0, 30]}\n            angle={0.3}\n            penumbra={1}\n            intensity={2}\n            castShadow\n            shadow-mapSize-width={256}\n            shadow-mapSize-height={256} />\n          <pointLight position={[-30, 0, -30]} intensity={0.5} />\n          <group\n            scale={[0.07, 0.07, 0.07]}\n          >\n            <Collider />\n            <Bowl rotation={[0, 0, 0]} />\n            {transitions((props, item) => (\n              <Ball\n                {...item}\n                {...props}\n                name={item}\n                startPos={[randomRange(-1, 1), 9, randomRange(-1, 1)]}\n              />\n            ))}\n          </group>\n        </group>\n      </Physics>\n    </>\n  )\n}\n\nexport default Scene\n","import { useRef, useEffect } from 'react'\n\nfunction useInterval(callback, delay) {\n  const savedCallback = useRef()\n\n  useEffect(() => {\n    savedCallback.current = callback\n  })\n\n  useEffect(() => {\n    function tick() {\n      if (typeof savedCallback?.current !== 'undefined') {\n        savedCallback?.current()\n      }\n    }\n\n    if (delay !== null) {\n      const id = setInterval(tick, delay)\n      return () => clearInterval(id)\n    }\n\n  }, [delay])\n}\n\nexport default useInterval","import React, { useRef, useState } from \"react\"\nimport { ARCanvas } from \"@react-three/xr\"\n\nimport useStore from \"./../store\"\nimport { trackableImage as createTrackableImage } from \"./../services/xr\"\nimport Scene from \"./Scene\"\nimport useInterval from \"./../utils/useInterval\"\n\nfunction App() {\n  const store = useStore()\n  const image = useRef()\n  const [trackableImage, setTrackableImage] = useState()\n\n  useInterval(\n    () => {\n      store.addBall()\n    },\n    store.isXR ? 3000 : null\n  )\n\n  const doCreateTrackableImage = async () => {\n    try {\n      const currTrackableImage = await createTrackableImage(image.current, 0.1)\n      setTrackableImage(currTrackableImage.image)\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  return (\n    <>\n      <div className=\"intro\">\n        <section>\n          <h1 className=\"title\">WebXR Image Target – Hole 🕳️</h1>\n          <img\n            className=\"trackedImage\"\n            onLoad={() => doCreateTrackableImage()}\n            alt=\"is cool\"\n            ref={image}\n            src={process.env.PUBLIC_URL + \"/trackedImage.jpg\"} />\n        </section>\n        <section>\n          <ol className=\"explanation\">\n            <li>\n              <button\n                onClick={() => window.print()}>\n                Print image\n                  <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"1em\"\n                  height=\"1em\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"#e2e2e2\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"square\"\n                  strokeLinejoin=\"arcs\"\n                >\n                  <path d=\"M7 17l9.2-9.2M17 17V7H7\" />\n                </svg>\n              </button>  10cm x 10cm\n            </li>\n            <li>Start AR</li>\n            <li>Scan image on flat surface</li>\n          </ol>\n\n        </section>\n\n        <section>\n          <hr />\n          <small className=\"compatibility\">\n            Currently only available in Chrome for Android &gt;=89, with flag <span className=\"snippet\">chrome://flags#webxr-incubations</span> active\n          </small>\n          <small className=\"credit\">\n            by <a href=\"https://thomasrutzer@github.io\" target=\"blank\">\n              Thomas Rutzer\n            <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"1em\"\n                height=\"1em\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                strokeWidth=\"2\"\n                strokeLinecap=\"square\"\n                strokeLinejoin=\"arcs\"\n              >\n                <path d=\"M7 17l9.2-9.2M17 17V7H7\" />\n              </svg>\n            </a>\n          </small>\n        </section>\n      </div>\n\n      { trackableImage &&\n        <ARCanvas\n          style={{ position: \"absolute\", left: 0, top: 0 }}\n          sessionInit={{\n            requiredFeatures: [\"image-tracking\"],\n            trackedImages: [trackableImage]\n          }}>\n          <Scene />\n        </ARCanvas>\n      }\n    </>\n  )\n}\n\nexport default App","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}